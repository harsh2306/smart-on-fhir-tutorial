{"mappings":"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","sources":["src/js/example-smart-app.js"],"sourcesContent":["(function(window){\r\n  window.extractData = function() {\r\n    var ret = $.Deferred();\r\n\r\n    function onError() {\r\n      console.log('Loading error', arguments);\r\n      ret.reject();\r\n    }\r\n\r\n    function onReady(smart)  {\r\n      console.log('Patient present in smart:' , smart.hasOwnProperty('patient'))\r\n      if (smart.hasOwnProperty('patient')) {\r\n        var patient = smart.patient;\r\n        var pt = patient.read();\r\n        var obv = smart.patient.api.fetchAll({\r\n                    type: 'Observation',\r\n                    query: {\r\n                      code: {\r\n                        $or: ['http://loinc.org|8302-2', 'http://loinc.org|8462-4',\r\n                              'http://loinc.org|8480-6', 'http://loinc.org|2085-9',\r\n                              'http://loinc.org|2089-1', 'http://loinc.org|55284-4']\r\n                      }\r\n                    }\r\n                  });\r\n\r\n        $.when(pt, obv).fail(onError);\r\n\r\n        $.when(pt, obv).done(function(patient, obv) {\r\n          var byCodes = smart.byCodes(obv, 'code');\r\n          var gender = patient.gender;\r\n\r\n          var fname = '';\r\n          var lname = '';\r\n\r\n          if (typeof patient.name[0] !== 'undefined') {\r\n            fname = patient.name[0].given.join(' ');\r\n            lname = patient.name[0].family.join(' ');\r\n          }\r\n\r\n          var height = byCodes('8302-2');\r\n          var systolicbp = getBloodPressureValue(byCodes('55284-4'),'8480-6');\r\n          var diastolicbp = getBloodPressureValue(byCodes('55284-4'),'8462-4');\r\n          var hdl = byCodes('2085-9');\r\n          var ldl = byCodes('2089-1');\r\n\r\n          var p = defaultPatient();\r\n          p.birthdate = patient.birthDate;\r\n          p.gender = gender;\r\n          p.fname = fname;\r\n          p.lname = lname;\r\n          p.height = getQuantityValueAndUnit(height[0]);\r\n\r\n          if (typeof systolicbp != 'undefined')  {\r\n            p.systolicbp = systolicbp;\r\n          }\r\n\r\n          if (typeof diastolicbp != 'undefined') {\r\n            p.diastolicbp = diastolicbp;\r\n          }\r\n\r\n          p.hdl = getQuantityValueAndUnit(hdl[0]);\r\n          p.ldl = getQuantityValueAndUnit(ldl[0]);\r\n\r\n          ret.resolve(p);\r\n        });\r\n      } else {\r\n        onError();\r\n      }\r\n    }\r\n\r\n    FHIR.oauth2.ready(onReady, onError);\r\n    return ret.promise();\r\n\r\n  };\r\n\r\n  function defaultPatient(){\r\n    return {\r\n      fname: {value: ''},\r\n      lname: {value: ''},\r\n      gender: {value: ''},\r\n      birthdate: {value: ''},\r\n      height: {value: ''},\r\n      systolicbp: {value: ''},\r\n      diastolicbp: {value: ''},\r\n      ldl: {value: ''},\r\n      hdl: {value: ''},\r\n    };\r\n  }\r\n\r\n  function getBloodPressureValue(BPObservations, typeOfPressure) {\r\n    var formattedBPObservations = [];\r\n    BPObservations.forEach(function(observation){\r\n      var BP = observation.component.find(function(component){\r\n        return component.code.coding.find(function(coding) {\r\n          return coding.code == typeOfPressure;\r\n        });\r\n      });\r\n      if (BP) {\r\n        observation.valueQuantity = BP.valueQuantity;\r\n        formattedBPObservations.push(observation);\r\n      }\r\n    });\r\n\r\n    return getQuantityValueAndUnit(formattedBPObservations[0]);\r\n  }\r\n\r\n  function getQuantityValueAndUnit(ob) {\r\n    if (typeof ob != 'undefined' &&\r\n        typeof ob.valueQuantity != 'undefined' &&\r\n        typeof ob.valueQuantity.value != 'undefined' &&\r\n        typeof ob.valueQuantity.unit != 'undefined') {\r\n          return ob.valueQuantity.value + ' ' + ob.valueQuantity.unit;\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  window.drawVisualization = function(p) {\r\n    $('#holder').show();\r\n    $('#loading').hide();\r\n    $('#fname').html(p.fname);\r\n    $('#lname').html(p.lname);\r\n    $('#gender').html(p.gender);\r\n    $('#birthdate').html(p.birthdate);\r\n    $('#height').html(p.height);\r\n    $('#systolicbp').html(p.systolicbp);\r\n    $('#diastolicbp').html(p.diastolicbp);\r\n    $('#ldl').html(p.ldl);\r\n    $('#hdl').html(p.hdl);\r\n  };\r\n\r\n})(window);\r\n"],"names":[],"version":3,"file":"index.03a7a6b0.js.map","sourceRoot":"/__parcel_source_root/"}